Search.setIndex({"alltitles": {"Attention Pytorch Code.": [[4, "attention-pytorch-code"]], "Blogs Landing Page": [[0, null]], "Conclusion": [[4, "conclusion"]], "CuBLAS": [[3, "cublas"]], "CuBLAS Error": [[3, "cublas-error"]], "Entire code.": [[4, "entire-code"]], "Finding Maximum And Sum Of An Array.": [[3, "finding-maximum-and-sum-of-an-array"]], "Finding the row maximum of a (N,C) dimesnion array. N is a power of 2 and greater than 31.": [[3, "finding-the-row-maximum-of-a-n-c-dimesnion-array-n-is-a-power-of-2-and-greater-than-31"]], "Finding the row sum of a (N,C) dimesnion array. N is a power of 2 and greater than 31.": [[3, "finding-the-row-sum-of-a-n-c-dimesnion-array-n-is-a-power-of-2-and-greater-than-31"]], "Flash Attention - I": [[3, null]], "Flash Attention - II": [[4, null]], "Flash Attention Cuda Coda": [[4, "flash-attention-cuda-coda"]], "Flash Attention.": [[4, "flash-attention"]], "Function Prototype": [[3, "function-prototype"]], "How This Code Reduces Time (Compared to Naive GPU code)": [[4, "how-this-code-reduces-time-compared-to-naive-gpu-code"]], "Instruction Dispatch and Memory": [[2, null]], "Lets write a program to find the max within an array of size = 32(wrap size).": [[3, "lets-write-a-program-to-find-the-max-within-an-array-of-size-32-wrap-size"]], "Lets write a program to find the max within an array whose size is a power of 2 and greater 31.": [[3, "lets-write-a-program-to-find-the-max-within-an-array-whose-size-is-a-power-of-2-and-greater-31"]], "Little bit about L1, L2 and global memory working": [[2, "little-bit-about-l1-l2-and-global-memory-working"]], "Miscellaneous Code": [[4, "miscellaneous-code"]], "More About Shared Memory": [[2, "more-about-shared-memory"]], "Motivation": [[1, "motivation"]], "Probability Spaces And Random Variables": [[1, "probability-spaces-and-random-variables"]], "Setting up cuBLAS": [[3, "setting-up-cublas"]], "Shared Memory": [[2, "shared-memory"]], "Some Functions and Classes To Knoww": [[3, "some-functions-and-classes-to-knoww"]], "Some optimization tips to achieve maximum efficiency.": [[2, "some-optimization-tips-to-achieve-maximum-efficiency"]], "Step 0: Defining the inputs and outputs.": [[4, "step-0-defining-the-inputs-and-outputs"]], "Step 1 - Permute: Splitting the input qkv into q, k, v. By calling the permute kernel.": [[4, "step-1-permute-splitting-the-input-qkv-into-q-k-v-by-calling-the-permute-kernel"]], "Step 2 - Dot Product: Dot product of q and k to compute preattn.": [[4, "step-2-dot-product-dot-product-of-q-and-k-to-compute-preattn"]], "Step 3: SCALE and MASK.": [[4, "step-3-scale-and-mask"]], "Step 4: Softmax kernel.": [[4, "step-4-softmax-kernel"]], "Step 5: Ouput of attention matrix and V.": [[4, "step-5-ouput-of-attention-matrix-and-v"]], "Step 6: Last step, Unpermute Y.": [[4, "step-6-last-step-unpermute-y"]], "The Bottleneck: Why is Standard Attention Slow?": [[4, "the-bottleneck-why-is-standard-attention-slow"]], "The Vanilla Self-Attention: Math Refresher": [[4, "the-vanilla-self-attention-math-refresher"]], "Types of Memories": [[2, "types-of-memories"]], "Understanding Weiner Process": [[1, null]], "Weiner Process": [[1, "weiner-process"]], "Why coalesing matters?": [[2, "why-coalesing-matters"]], "Wrap And Wrap Scheduler": [[2, "wrap-and-wrap-scheduler"]], "cublasSgemmStridedBatched in CUDA": [[3, "cublassgemmstridedbatched-in-cuda"]], "cudaGetDeviceProperties()": [[3, "cudagetdeviceproperties"]], "cudaSetDevice()": [[3, "cudasetdevice"]]}, "docnames": ["00-landing-page", "01-weiner-process", "02-instruction-dispatch-and-memory", "03-flash-attention-I", "04-flash-attention-II"], "envversion": {"sphinx": 62, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1}, "filenames": ["00-landing-page.md", "01-weiner-process.md", "02-instruction-dispatch-and-memory.md", "03-flash-attention-I.md", "04-flash-attention-II.md"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [1, 2, 3, 4], "0": [1, 2, 3], "079": 4, "0f": [2, 4], "0th": [3, 4], "0x0000000f": 3, "0x0000ffff": 3, "0xffffffff": [3, 4], "1": [1, 2, 3], "10": [2, 3, 4], "100": [2, 4], "1023": 3, "10239": 3, "1024": [2, 3, 4], "1060": 2, "11": 3, "11263": 3, "12": [3, 4], "12287": 3, "125": 2, "127": 2, "128": [2, 4], "13": 3, "13311": 3, "14": [2, 3], "14335": 3, "15": 3, "15359": 3, "159": 2, "16": [2, 3, 4], "16383": 3, "17": [2, 3], "17407": 3, "18": [2, 3], "18431": 3, "19": 3, "19455": 3, "1e": 4, "2": [1, 2], "20": 3, "2047": 3, "20479": 3, "21": 3, "21503": 3, "22": 3, "223": 2, "224": 2, "22527": 3, "23": [2, 3], "233": 2, "23551": 3, "24": [2, 3], "24575": 3, "25": 3, "255": 2, "25599": 3, "256": [2, 3, 4], "26": 3, "26623": 3, "27": 3, "27647": 3, "28": 3, "28671": 3, "287": 2, "29": 3, "29695": 3, "3": [2, 3], "30": 3, "3071": 3, "30719": 3, "31": 2, "31429377": 4, "31743": 3, "32": [2, 4], "32767": 3, "36": 2, "389000": 2, "3c": 4, "3d": 1, "3f": 4, "3x": 4, "4": [2, 3], "4095": 3, "454000": 2, "472000": 2, "480": 2, "4d": 4, "4f": 4, "5": [2, 3], "50": 2, "511": 2, "5119": 3, "512": [2, 4], "523776": 3, "524800": 3, "525824": 3, "526848": 3, "527872": 3, "528896": 3, "529920": 3, "530944": 3, "531968": 3, "532992": 3, "534016": 3, "535040": 3, "536064": 3, "537088": 3, "538112": 3, "539136": 3, "540160": 3, "541184": 3, "542208": 3, "543232": 3, "544256": 3, "545280": 3, "546304": 3, "547328": 3, "548352": 3, "549376": 3, "550400": 3, "551424": 3, "552448": 3, "553472": 3, "554496": 3, "555520": 3, "6": [2, 3], "6143": 3, "63": 3, "64": [2, 3, 4], "642000": 2, "67": 4, "7": [2, 3], "7167": 3, "768": 4, "79": 2, "8": [2, 3, 4], "8191": 3, "8192": [2, 4], "9": 3, "9215": 3, "96": 2, "A": [0, 1, 2, 3], "AND": 4, "And": 4, "As": [1, 2, 3, 4], "At": 1, "But": 2, "By": [1, 2], "For": [1, 2, 3, 4], "If": [1, 2, 3, 4], "In": [1, 2, 3, 4], "It": [1, 2, 3, 4], "Its": 2, "No": 3, "Not": 2, "One": [2, 3], "That": [1, 4], "The": [1, 2, 3], "Then": [3, 4], "There": 1, "To": [1, 2], "_": [1, 2, 4], "__device__": 4, "__file__": [2, 3, 4], "__global__": [2, 3, 4], "__host__": 4, "__line__": [2, 3, 4], "__shared__": [2, 3, 4], "__shfl_down_sync": [3, 4], "__shfl_xor_sync": 4, "__syncthread": [2, 3, 4], "a_1": 1, "a_2": 1, "a_3": 1, "a_n": 1, "a_shar": 2, "a_val": 2, "about": [1, 3, 4], "abov": [1, 2, 3, 4], "absent": 3, "absolut": 2, "acccess": 2, "acces": 2, "access": [2, 3, 4], "accumul": [2, 4], "accur": 4, "accuraci": 4, "accuracy_threshold": 4, "achiev": 4, "across": [2, 3, 4], "activ": 3, "ad": 1, "add": [1, 2], "add_vector": 2, "addit": [1, 3, 4], "address": 2, "adjac": 2, "advanc": 4, "after": [1, 2, 3, 4], "again": 2, "aggreg": 4, "al": 4, "algebra": 1, "algo": 2, "algorithm": [1, 2, 4], "align": [2, 4], "all": [1, 2, 3, 4], "alloc": [2, 3, 4], "allow": [2, 3, 4], "almost": 1, "along": 4, "alpha": [1, 3, 4], "alreadi": 2, "also": [1, 2, 3, 4], "alu": 3, "alwai": [2, 3], "am": 2, "among": 2, "amout": 2, "an": [1, 2, 4], "andrej": [3, 4], "ani": [1, 2, 3, 4], "anoth": [2, 3, 4], "api": 3, "appar": 4, "appli": 4, "applic": 3, "approach": 4, "ar": [1, 2, 3, 4], "architectur": 4, "argc": 4, "argument": 2, "argv": 4, "arr": 4, "arrai": [2, 4], "arrang": 4, "asiz": 3, "asll": 2, "assembl": 4, "assert": 4, "assig": 1, "assign": [1, 4], "associ": 3, "assum": [2, 3, 4], "att": 4, "att_bth": 4, "att_btht2": 4, "attempt": [2, 4], "attend": 4, "attent": 1, "attention_forward": 4, "attention_forward_cpu": 4, "attention_forward_cuda": 4, "attn": 4, "autoregress": 4, "avail": 2, "availab": 2, "avoid": [1, 2, 4], "awai": 2, "awar": 4, "b": [2, 3, 4], "b_share": 2, "b_val": 2, "back": [1, 2, 4], "backward": 1, "balanc": 2, "ball": 1, "banach": 1, "bandwidth": 4, "barrier": 4, "base": [0, 1, 3, 4], "basic": 2, "batch": [3, 4], "batch_siz": 3, "batchcount": 3, "beacaus": 4, "beacus": 4, "becaus": [1, 2, 3, 4], "becom": 4, "becuas": 3, "befor": [3, 4], "begin": 2, "behavior": 3, "behind": 1, "being": [2, 4], "beleiv": 1, "believ": 3, "belong": [1, 3], "below": [1, 2, 3, 4], "benchmark": 4, "benchmark_kernel": 4, "beta": [1, 3, 4], "better": [2, 4], "between": [2, 3, 4], "bia": 4, "big": 4, "bigcup_": 1, "bit": 4, "block": [2, 3, 4], "block_siz": [2, 3, 4], "blockdim": [2, 3, 4], "blockidx": [2, 3, 4], "blog": [1, 3, 4], "borel": 1, "both": [1, 2, 3], "bound": 4, "break": [1, 4], "brief": 1, "broadcast": 4, "bu": 2, "buffer": 4, "build": 4, "built": 4, "busi": 2, "byte": [2, 3], "c": [1, 2, 4], "c3": 4, "c_col": 4, "cach": [2, 4], "calcul": [2, 3, 4], "calcula": 1, "call": [1, 2, 3], "can": [1, 2, 3, 4], "cannot": [1, 2], "cap": 1, "capabl": 2, "capac": 2, "care": 1, "carefulli": 1, "case": [1, 2], "catch": 3, "categori": 1, "causal": 4, "cdot": [3, 4], "ceil_div": 4, "certain": 2, "chang": [1, 3], "chapter": [2, 3, 4], "char": [2, 3, 4], "check": [2, 3, 4], "chip": 4, "chose": 1, "chosen": 1, "class": 4, "classic": 1, "clear": [2, 4], "clock": 2, "clock_t": 2, "clocks_per_sec": 2, "close": 1, "closer": 4, "closur": 1, "cmath": 4, "coalesc": [2, 4], "coarsen": [3, 4], "code": [2, 3], "collect": [0, 1, 2], "column": [2, 3], "com": 4, "combin": 4, "come": [3, 4], "command": 4, "common": 4, "commun": [3, 4], "compar": 3, "comparison": 4, "compil": 2, "complement": 1, "complex": 4, "complic": 4, "compon": 4, "compris": 2, "compromis": [3, 4], "comput": [1, 2, 3], "computation": 4, "concaten": 4, "concept": [2, 4], "conceptu": 4, "concurr": 2, "condit": 1, "conjug": 3, "consecut": 2, "conserv": 1, "consid": [1, 2], "consist": 1, "const": [2, 3, 4], "construct": 1, "consum": 2, "contain": 3, "context": 3, "contigi": 2, "contigu": [2, 4], "continu": [1, 4], "contradict": 1, "control": [2, 3], "coordin": 4, "copi": 2, "core": 4, "correct": 4, "correctli": 4, "correl": 1, "correspond": [2, 3, 4], "cost": 4, "costli": 2, "could": 4, "countabl": 1, "cout": [3, 4], "cover": 4, "cpu": 4, "cpu_ref": 4, "cpu_refer": 4, "creat": [2, 3, 4], "crucial": 4, "cu": 4, "cubla": 4, "cublas_default_math": 4, "cublas_handl": [3, 4], "cublas_math_mod": 4, "cublas_op_c": 3, "cublas_op_n": [3, 4], "cublas_op_t": [3, 4], "cublas_status_success": [3, 4], "cublas_tf32_tensor_op_math": 4, "cublas_v2": 4, "cublascheck": [3, 4], "cublascr": [3, 4], "cublasdestroi": [3, 4], "cublashandle_t": [3, 4], "cublasmath_t": 4, "cublasoperation_t": 3, "cublassetmathmod": 4, "cublassgemmstridedbatch": 4, "cublasstatus_t": [3, 4], "cuda": 2, "cuda_check": [2, 4], "cuda_runtim": 3, "cudacheck": [2, 3, 4], "cudadevicegetattribut": 3, "cudadeviceprop": [3, 4], "cudaerror_t": [2, 3, 4], "cudaevent_t": 4, "cudaeventcr": 4, "cudaeventelapsedtim": 4, "cudaeventrecord": 4, "cudaeventsynchron": 4, "cudafre": [3, 4], "cudagetdevic": 3, "cudagetdeviceproperti": 4, "cudageterrorstr": [2, 4], "cudainitdevic": 3, "cudamalloc": [2, 3, 4], "cudamemcpi": [2, 3, 4], "cudamemcpydevicetohost": [2, 3, 4], "cudamemcpyhosttodevic": [2, 3, 4], "cudamemset": [3, 4], "cudasetdevic": 4, "cudasetvaliddevic": 3, "cudasuccess": [2, 4], "cudasync": 2, "cudnn": 4, "current": [3, 4], "custom": 4, "cycl": 2, "d": [2, 3, 4], "d_": 4, "d_a": [2, 3], "d_att": 4, "d_attn": 4, "d_b": 2, "d_c": [2, 3], "d_inp": 4, "d_k": 4, "d_out": 4, "d_preatt": 4, "d_preattn": 4, "d_qkvr": 4, "d_v": 4, "d_vaccum": 4, "dao": 4, "data": [2, 3, 4], "debug": 4, "decid": [2, 3], "declar": 2, "decod": 4, "decompos": 1, "deconstruct": 4, "deeper": 1, "def": 4, "default": 3, "defin": [1, 2, 3], "definit": 1, "delta": 3, "demonstr": 3, "depend": [2, 3, 4], "depict": 2, "describ": 1, "detail": [1, 3], "determinist": 1, "devic": [2, 3, 4], "device_result": 4, "deviceidx": [3, 4], "deviceprop": [3, 4], "did": 4, "differ": [2, 4], "differenti": 1, "differernt": 1, "diffus": 1, "dim": [3, 4], "dim3": 2, "dimens": [3, 4], "dimension": [3, 4], "direct": [2, 4], "directli": [3, 4], "discontiu": 1, "discuss": [1, 3], "disjoint": 1, "dispatch": 4, "displac": 1, "distribut": 1, "divid": 4, "dividend": 4, "divis": 4, "divisor": 4, "do": [2, 3, 4], "document": 3, "doe": [1, 2, 3, 4], "doesn": 2, "domin": 4, "don": [2, 3], "done": [2, 4], "dot": [2, 3], "doubl": [1, 2, 3], "down": [1, 2, 3, 4], "dram": 2, "drastic": 4, "drift": 1, "driver": 3, "ds_t": 1, "dsize": 2, "dt": 1, "dual": 2, "due": 2, "dummi": 4, "duplic": 1, "dure": [2, 3, 4], "dw_t": 1, "dx": 1, "dynam": [2, 4], "e": [1, 3, 4], "e_i": 1, "e_j": 1, "each": [1, 2, 3, 4], "easi": 4, "effect": 4, "effici": [3, 4], "either": 3, "elapsed_tim": 4, "element": [1, 2, 3, 4], "elementwis": 4, "els": 4, "embed": 4, "emploi": 4, "empti": 1, "emptyset": 1, "enable_bf16": 4, "enable_tf32": 4, "encount": 1, "end": 1, "endif": 4, "endl": 3, "enough": 2, "ensur": [1, 4], "entir": 1, "entri": 4, "epsilon": [1, 4], "epsilon_t": 1, "equal": 4, "equat": 1, "err": [2, 4], "error": [2, 4], "especaili": 1, "especi": 4, "et": 4, "etc": [1, 2], "even": 4, "event": [1, 3], "everi": [1, 3, 4], "everyon": 3, "everyth": 2, "evolv": 1, "ex": 4, "exact": 4, "exampl": [1, 2, 3, 4], "except": 3, "exclud": 1, "exclus": 3, "execut": [2, 3, 4], "exit": [2, 3, 4], "exit_failur": [2, 3, 4], "exp": 4, "expect": [1, 3, 4], "expf": 4, "explain": 3, "explan": [1, 3], "explanatori": 4, "explicit": 4, "explicitli": [3, 4], "exploit": 4, "exponenti": 4, "expsum": 4, "expsum_inv": 4, "expv": 4, "extern": [2, 3, 4], "extra": 2, "extrem": 4, "f": [1, 2, 4], "fab": 4, "fact": 2, "fail": 1, "fall": [1, 2], "far": 2, "fashion": 4, "fast": [2, 4], "faster": 4, "fastest": 2, "featur": 4, "fetch": 2, "few": 4, "fewer": 4, "fig": 2, "figur": [2, 3], "file": [2, 3, 4], "final": [1, 3, 4], "financ": 1, "find": [2, 4], "findmax": 3, "finish": 3, "finit": 1, "first": [2, 3, 4], "fit": 2, "five": 2, "flash_attent": 4, "flash_attention_blog": 4, "flashattent": 4, "float": [2, 3, 4], "flow": 1, "flt_epsilon": 4, "flt_max": 4, "fluctuat": 1, "flush": 4, "flush_buff": 4, "fly": 4, "fmaxf": 4, "follow": 1, "follwo": 3, "forc": 1, "form": [1, 4], "formal": 1, "formul": [1, 4], "forward": [1, 4], "found": 3, "four": 2, "fp16": 4, "fp32": 4, "frac": [1, 4], "free": 4, "from": [1, 2, 3, 4], "full": [2, 4], "function": [1, 4], "funtion": 4, "further": [2, 4], "furthermor": 4, "fuse": 4, "fusion": 4, "futur": 4, "g": [1, 4], "gausian": 1, "gaussian": 1, "gave": 1, "gemm": 4, "gemmstridedbatch": 3, "gener": [1, 4], "get": [1, 2, 3, 4], "give": [1, 2, 3, 4], "given": [1, 2, 3, 4], "global": [3, 4], "globali": 2, "go": [2, 3, 4], "goal": 4, "goe": 4, "gpt": [3, 4], "gpu": [2, 3], "gradient": 4, "grid": 2, "grid_siz": 4, "ground": [3, 4], "group": 2, "guarante": 1, "guid": 3, "h": [2, 3, 4], "h_a": [2, 3], "h_b": 2, "h_c": [2, 3], "ha": [1, 2, 3, 4], "half": 4, "handl": [2, 3, 4], "happen": [2, 3, 4], "happend": 3, "hard": 1, "hardwar": [2, 4], "have": [2, 3, 4], "hbm": 4, "head": 4, "headdim": 4, "help": [1, 2, 4], "here": [1, 2, 3, 4], "herirach": 1, "hidden": 2, "hierarchi": 4, "high": 4, "higher": 4, "highli": 4, "hold": 1, "hope": [1, 2], "host": [2, 3, 4], "how": [1, 2, 3], "howev": 4, "http": 4, "huge": 4, "i": [1, 2], "id": [3, 4], "idea": [2, 3, 4], "ideal": 4, "ident": 1, "identifi": [2, 3], "idi": 2, "idx": [2, 3, 4], "ie": 2, "ifndef": 4, "ij": 4, "ill": 1, "imag": [1, 2], "immedi": 1, "implement": 4, "implemet": 4, "implicit": 4, "implicitli": 3, "import": 4, "improv": 4, "includ": [2, 3, 4], "incorrect": 3, "increment": 1, "independ": [1, 2, 4], "index": [1, 2, 3, 4], "indic": 4, "individu": [1, 3], "inf": [3, 4], "infin": [1, 4], "infinit": 1, "infinitesim": 1, "influenc": 1, "info": [2, 3, 4], "inform": [1, 3, 4], "infti": [1, 4], "init": 2, "initi": [1, 2, 3], "initial": 3, "inner": 2, "inp": [3, 4], "inp_idx": 4, "inp_idx_k": 4, "inp_idx_q": 4, "inp_idx_v": 4, "input": [2, 3], "insid": [2, 3], "instanc": [1, 3], "instant": 1, "instead": [2, 3, 4], "instruct": [3, 4], "int": [1, 2, 3, 4], "int_": 1, "int_0": [], "int_min": 3, "integr": 1, "intens": 4, "inter": [3, 4], "intermedi": 4, "intern": [1, 4], "interpret": 3, "interv": 1, "intial": 1, "intra": [3, 4], "intro": 1, "intruct": 2, "intuit": 1, "invalid": 2, "invari": 1, "involv": 1, "iostream": [3, 4], "isfinit": 4, "isn": 4, "isol": 3, "issu": [2, 4], "iter": [2, 3, 4], "ithi": 3, "ito": 1, "its": [1, 2, 3, 4], "itself": [1, 4], "j": [1, 3, 4], "jointli": 4, "journei": 4, "junk": 3, "just": 4, "k": [2, 3], "karpathi": [3, 4], "keep": [2, 3, 4], "kei": [1, 4], "kept": 4, "kernel": [2, 3], "kernel3": 4, "kernel_arg": 4, "kernelarg": 4, "key_idx": 4, "key_t2": 4, "keyword": 2, "kick": 1, "kind": 2, "kinda": 1, "know": [1, 2, 3, 4], "kv": 4, "l2": 4, "l2caches": 4, "lane": 3, "laneid": [3, 4], "larg": [2, 4], "last": 3, "lastli": 2, "latenc": [2, 4], "later": [1, 2], "latter": 4, "launch": [2, 3, 4], "launcha": 4, "layer": 4, "layout": 4, "lcubla": 4, "lda": 3, "ldb": 3, "ldc": 3, "ldot": 1, "lead": 3, "learn": 0, "leav": 2, "lebesgu": 1, "lectur": 2, "left": [1, 3], "lemma": 1, "length": 4, "less": [2, 3, 4], "let": [1, 2, 4], "level": 3, "leverag": 4, "li": 1, "librari": [3, 4], "like": [1, 2, 4], "lim_": 1, "limit": [2, 3], "line": [2, 3, 4], "linear": 4, "linearli": 4, "link": 2, "list": 3, "litt": 2, "live": 1, "load": [2, 4], "local": 4, "locat": 4, "lock": 3, "logic": [3, 4], "long": 3, "look": [1, 4], "loop": 2, "loss": 4, "lot": [3, 4], "lower": 4, "lru": 2, "m": [3, 4], "m_": 4, "made": [3, 4], "mai": [2, 3, 4], "main": [2, 3, 4], "major": 4, "majorli": 2, "make": [1, 2, 3, 4], "make_random_float": 4, "malloc": 4, "manag": 4, "mani": [1, 2], "mannual": 2, "manual": [2, 4], "map": 1, "mask": 3, "masked_fil": 4, "mass": 1, "match": 4, "math": 1, "mathbb": 1, "mathcal": 1, "mathemat": [3, 4], "matirx": 2, "matmul": 4, "matric": [3, 4], "matrix": [2, 3], "max": 4, "max_result": 3, "max_val": [3, 4], "max_valu": 3, "maxim": [2, 4], "maximum": [1, 4], "maxval": [3, 4], "mean": [1, 2, 3, 4], "meaning": 1, "measur": 1, "mechan": [3, 4], "memomri": [2, 4], "memori": [3, 4], "memset": 4, "mention": 2, "might": [1, 2, 3, 4], "million": 4, "min": 4, "mind": 3, "minim": 4, "mismatch": [2, 4], "mmul": 2, "mode": 3, "model": [1, 3, 4], "modern": 1, "modifi": 2, "moe": 1, "more": [1, 3, 4], "moreov": 1, "morev": 1, "most": [3, 4], "mostli": 1, "motion": 1, "move": [1, 4], "movement": 4, "much": [1, 2, 4], "multi": 4, "multipl": [2, 3, 4], "multipli": [2, 3, 4], "must": [1, 3, 4], "my": 0, "n": [1, 2, 4], "n_embd": 4, "n_head": 4, "naiv": 2, "name": 4, "na\u00efv": 1, "neccessari": [2, 4], "necessari": 4, "need": [1, 2, 3, 4], "neg": 4, "neighbour": 2, "neq": 1, "never": 4, "new": [1, 2, 4], "next": [2, 4], "nfault": 4, "nh": 4, "nh_": 4, "non": 1, "none": 2, "normal": [1, 4], "note": [2, 3, 4], "notic": 1, "now": [1, 2, 3, 4], "nowher": 1, "nullptr": 4, "num_block": 4, "num_el": 4, "number": [1, 2, 3, 4], "numer": 4, "numhead": 4, "nvbench": 4, "nvcc": 4, "nvidia": [3, 4], "o": 4, "occur": 3, "od": 1, "offer": 3, "offeset": 3, "offici": 3, "offset": [3, 4], "often": [2, 3, 4], "okai": 4, "old": 2, "omega": 1, "onc": [2, 3], "one": [1, 2, 3, 4], "ones": 4, "onli": [1, 2, 3, 4], "onlin": 4, "op": 3, "oper": [2, 3, 4], "optim": 4, "optimis": 2, "option": [3, 4], "orderli": 2, "origin": [1, 4], "other": [1, 2, 3], "other_idx": 4, "otherwis": [1, 3], "ou": 1, "ouput": 2, "our": [1, 2, 3, 4], "out": [2, 3, 4], "out_bth": 4, "out_gpu": 4, "outcom": 1, "outer": 2, "output": [2, 3], "outsid": [1, 4], "over": [1, 2, 4], "overal": 2, "overflow": 4, "overhead": 4, "overlap": [1, 3], "p": [1, 4], "p_": 4, "pack": 4, "pad": [2, 4], "pai": 4, "pair": 1, "pairwis": 1, "paper": 4, "paradox": 1, "paral": 3, "paramet": [2, 3], "part": [1, 3, 4], "particip": 3, "particular": [2, 3], "particularli": 4, "partit": [1, 3], "pass": [3, 4], "path": 1, "pattern": 4, "peak": 4, "pemut": 4, "per": [2, 3, 4], "perfect": 2, "perform": [3, 4], "permute_kernel": 4, "physic": 1, "pi": [], "pictur": 3, "piec": [1, 4], "pipelin": 2, "place": 3, "pleas": [2, 3, 4], "plu": 4, "point": [2, 4], "pointer": [3, 4], "poor": 2, "posit": [1, 3, 4], "possibl": 1, "post": 4, "potenti": 4, "power": 1, "powerset": 1, "pre": [1, 4], "preatt": 4, "preatt_bth": 4, "precis": [1, 4], "prepar": 4, "present": [2, 3, 4], "prevent": 4, "previou": [2, 3, 4], "primari": 3, "prime": 4, "primit": [3, 4], "print": 4, "printf": [2, 3, 4], "priorit": 3, "probabl": 4, "problem": 1, "proce": 4, "process": [2, 3, 4], "produc": 4, "product": [2, 3], "program": 2, "programm": 2, "prohibit": 3, "project": 4, "properti": [1, 3], "provid": [1, 2, 3, 4], "purpos": [2, 4], "put": [2, 4], "pv": 4, "qk": 4, "qkvr": 4, "quad": [1, 3], "queri": [3, 4], "query_idx": 4, "query_t": 4, "question": 4, "quickli": 4, "r": 1, "ram": 4, "rand": 4, "rand_max": 4, "random": 4, "randomli": 1, "rang": 4, "raw": 4, "re": [1, 4], "reach": [2, 4], "read": [2, 4], "real": 1, "realli": 1, "realt": 1, "realtiv": 2, "rearrang": [1, 4], "reassembl": 1, "recal": [1, 3, 4], "recap": 4, "recommend": 4, "recomput": 4, "reconstruct": 4, "record": 4, "rectifi": 1, "rectiflow": 1, "reduc": 3, "reduct": [2, 3, 4], "refernc": 2, "regard": 2, "region": [1, 2, 4], "regist": 4, "regular": 1, "releas": 3, "reli": 1, "remain": [3, 4], "remeb": 2, "rememb": [2, 3], "reorder": 2, "repeat": 4, "repeat_tim": 4, "repres": [1, 3, 4], "represent": 4, "request": [2, 3, 4], "requir": [2, 4], "reserv": 2, "reshap": 4, "resort": 3, "resourc": [2, 3], "respect": 2, "respons": 4, "rest": [2, 4], "restrict": 1, "result": [2, 3, 4], "return": [1, 2, 3, 4], "reus": 2, "riemann": 1, "right": 1, "rightarrow": 1, "rotat": 1, "roughli": 1, "round": 4, "routin": 4, "row": [2, 4], "row_sum": 3, "run": [1, 2, 3, 4], "runtim": 3, "s_": 4, "s_0": 1, "s_t": 1, "sadli": 2, "safer": 4, "sai": [1, 2, 3], "sake": 3, "same": [1, 2, 3, 4], "sampl": 1, "samplefunct": 2, "satisfi": 1, "satur": 2, "saw": 4, "scalar": 3, "scale_kernel": 4, "scenario": 2, "scheduer": 2, "schedul": 4, "scienc": 1, "scope": 1, "score": [1, 4], "scratch": 4, "scrub": 4, "sde": 1, "second": [2, 3, 4], "section": [1, 3], "see": [1, 2, 3, 4], "seem": 1, "seen": [2, 3, 4], "self": 3, "sens": 1, "sentenc": 2, "separ": 4, "sequenc": [1, 4], "sequencelength": 4, "seri": [3, 4], "servic": 4, "set": [1, 4], "setup": 4, "sever": [2, 4], "shape": 4, "share": [3, 4], "shared_mem_s": 4, "shared_memory_in_byt": 2, "shift": 3, "should": [2, 3, 4], "show": 1, "shuffl": [3, 4], "side": 4, "sigma": 1, "significantli": 4, "similar": [1, 3, 4], "simpli": [1, 2], "simplifi": 4, "simultan": 3, "sinc": [2, 3], "singl": [2, 4], "single_cal": 4, "size": [1, 2, 4], "size_t": 4, "sizeof": [2, 3, 4], "skip": 4, "slower": 4, "sm": 2, "small": 4, "smaller": 4, "so": [1, 2, 3, 4], "softmax_block_s": 4, "softmax_forward_kernel": 4, "softmax_forward_kernel4": 4, "solid": 1, "solv": 1, "some": [1, 4], "someth": [1, 4], "soon": 3, "sophist": 4, "sourc": 4, "space": [3, 4], "special": [3, 4], "specif": [3, 4], "specifi": [2, 3, 4], "speed": [2, 4], "sphere": 1, "spread": 2, "sqrt": 4, "sqrtf": 4, "sram": 4, "stabil": 4, "stabl": 4, "stackoverflow": 4, "stage": 4, "stai": 2, "start": [1, 2, 3, 4], "state": 1, "statu": [3, 4], "std": [3, 4], "stdio": [2, 3, 4], "stdlib": 4, "step": 1, "stocasht": 1, "stocast": 1, "stochast": 1, "stop": 4, "storag": 2, "store": [2, 3, 4], "strateg": 4, "strategi": 4, "stream": [3, 4], "strictli": 4, "stride": 4, "stridea": 3, "strideb": 3, "stridec": 3, "strive": 2, "structur": 1, "style": 4, "sub": 4, "subsequ": [2, 3, 4], "subset": 1, "subseteq": 1, "subspac": 4, "subtract": 4, "success": [2, 4], "suffic": 3, "sum": [1, 2, 4], "sum_": 1, "sum_val": 4, "sumval": 4, "support": 3, "suppos": 2, "sure": [1, 2, 3], "switch": 2, "synchron": [2, 4], "system": [1, 3], "t": [1, 2, 3, 4], "t0": 2, "t1": [2, 4], "t1sum": 2, "t2": [2, 4], "t2sum": 2, "t_": 1, "t_eff": 4, "t_i": 1, "take": [2, 4], "taken": [2, 3], "target": 4, "tarski": 1, "task": 4, "tau": 1, "techniqu": 4, "tell": 2, "temp": 2, "templat": 4, "temporarili": 4, "tensor": 4, "term": [1, 2], "text": [1, 3, 4], "tf32": 4, "th": [2, 4], "than": [2, 4], "thank": 1, "thei": 1, "them": [1, 2, 4], "theoret": 1, "theori": 1, "thi": [1, 2, 3], "thing": [1, 4], "third": 2, "thisshar": 3, "those": [1, 4], "though": 1, "thread": [2, 3, 4], "threadblock": 2, "threadd": 2, "threadid": 3, "threadidx": [2, 3, 4], "threads_per_block": 3, "three": [1, 2], "three_c": 4, "threshold": 4, "through": [3, 4], "throughput": 2, "throw": 2, "ti": 2, "tid": [3, 4], "tile": 4, "time": [1, 2, 3], "tlb": 4, "todo": 4, "togeth": [2, 4], "token": 4, "toler": 4, "too": 4, "took": 2, "torch": 4, "total": [2, 4], "total_sum": 4, "total_thread": 4, "toward": 4, "track": [2, 4], "traffic": 4, "train": [3, 4], "trajectori": 1, "transa": 3, "transact": 4, "transb": 3, "transfer": 2, "translat": [1, 4], "transpos": [3, 4], "tri": [1, 2], "tril": 4, "true": 4, "try": [1, 2, 3, 4], "turn": 3, "two": [1, 2, 3, 4], "type": [1, 3], "typic": [1, 4], "u": [1, 2], "uncount": 1, "undefin": 3, "under": [1, 2], "underflow": 4, "undergradu": 1, "understad": 1, "understand": [2, 4], "union": 1, "uniqu": 4, "unit": 1, "unlik": 1, "unmeasur": 1, "unpermute_kernel": 4, "unsign": 3, "up": [1, 2, 4], "updat": 3, "us": [1, 2, 3, 4], "usag": 4, "user": 4, "usual": [1, 4], "util": [2, 4], "utiliaz": 2, "utilis": 2, "vaccum": 4, "vae": 1, "val": [3, 4], "valid": [2, 3], "validate_result": 4, "valu": [1, 3, 4], "value_t2": 4, "var": [1, 3], "variabl": 4, "varibal": 1, "variou": 4, "ve": 4, "vector": 4, "vector_add": 2, "veri": [2, 3, 4], "version": 4, "via": [2, 4], "video": [3, 4], "view": 4, "void": [2, 3, 4], "volum": 1, "w": 1, "w_": 1, "w_t": 1, "wa": [1, 2], "wai": [1, 2, 4], "want": [1, 2, 4], "warp": [2, 3, 4], "warpid": [3, 4], "warpreducemax": [3, 4], "warpreducesum": [3, 4], "warpsiz": 3, "warpsperblock": [3, 4], "we": [1, 2, 3, 4], "weight": 4, "weineer": 1, "well": 3, "went": 2, "what": [2, 3], "when": [1, 2, 3, 4], "whenev": [1, 3], "where": [1, 2, 3, 4], "wherev": 3, "whether": 3, "which": [1, 2, 3, 4], "while": [2, 4], "whole": 4, "why": [1, 3], "wide": [2, 3, 4], "width": 3, "wiener": 1, "wil": 3, "wise": 4, "within": [1, 2, 4], "without": [1, 2, 3, 4], "won": [1, 4], "word": 1, "work": [1, 3], "would": [1, 3], "wrap": 4, "write": [2, 4], "written": 4, "wrote": 1, "x": [1, 2, 3, 4], "x_1": 1, "x_2": 1, "x_i": 4, "x_j": 4, "x_t": 1, "y": 2, "you": [1, 2, 3, 4], "zero": [1, 2, 3, 4], "\u03c3": 1, "\u03c9": 1, "\u03f5_t": 1, "\u211d\u00b3": 1, "\ud835\udcd5": 1}, "titles": ["Blogs Landing Page", "Understanding Weiner Process", "Instruction Dispatch and Memory", "Flash Attention - I", "Flash Attention - II"], "titleterms": {"0": 4, "1": 4, "2": [3, 4], "3": 4, "31": 3, "32": 3, "4": 4, "5": 4, "6": 4, "And": [1, 2, 3], "By": 4, "Of": 3, "The": 4, "To": 3, "about": 2, "achiev": 2, "an": 3, "arrai": 3, "attent": [3, 4], "bit": 2, "blog": 0, "bottleneck": 4, "c": 3, "call": 4, "class": 3, "coales": 2, "coda": 4, "code": 4, "compar": 4, "comput": 4, "conclus": 4, "cubla": 3, "cublassgemmstridedbatch": 3, "cuda": [3, 4], "cudagetdeviceproperti": 3, "cudasetdevic": 3, "defin": 4, "dimesnion": 3, "dispatch": 2, "dot": 4, "effici": 2, "entir": 4, "error": 3, "find": 3, "flash": [3, 4], "function": 3, "global": 2, "gpu": 4, "greater": 3, "how": 4, "i": [3, 4], "ii": 4, "input": 4, "instruct": 2, "k": 4, "kernel": 4, "knoww": 3, "l1": 2, "l2": 2, "land": 0, "last": 4, "let": 3, "littl": 2, "mask": 4, "math": 4, "matrix": 4, "matter": 2, "max": 3, "maximum": [2, 3], "memori": 2, "miscellan": 4, "more": 2, "motiv": 1, "n": 3, "naiv": 4, "optim": 2, "ouput": 4, "output": 4, "page": 0, "permut": 4, "power": 3, "preattn": 4, "probabl": 1, "process": 1, "product": 4, "program": 3, "prototyp": 3, "pytorch": 4, "q": 4, "qkv": 4, "random": 1, "reduc": 4, "refresh": 4, "row": 3, "scale": 4, "schedul": 2, "self": 4, "set": 3, "share": 2, "size": 3, "slow": 4, "softmax": 4, "some": [2, 3], "space": 1, "split": 4, "standard": 4, "step": 4, "sum": 3, "than": 3, "thi": 4, "time": 4, "tip": 2, "type": 2, "understand": 1, "unpermut": 4, "up": 3, "v": 4, "vanilla": 4, "variabl": 1, "weiner": 1, "whose": 3, "why": [2, 4], "within": 3, "work": 2, "wrap": [2, 3], "write": 3, "y": 4}})